<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zixy Bite - Digital Menu</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <style>
    html, body { height: 100%; margin: 0; }
    * { font-family: 'Inter', sans-serif; }
    h1, h2, h3, h4, h5, h6, .font-heading { font-family: 'Poppins', sans-serif; }
    
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    
    .category-pill { transition: all 0.3s ease; }
    .category-pill.active { background: #A8E63D; color: #0D0D0D; box-shadow: 0 0 20px rgba(168, 230, 61, 0.4); }
    
    .menu-card { transition: all 0.3s ease; }
    .menu-card:hover { transform: translateY(-4px); box-shadow: 0 8px 30px rgba(168, 230, 61, 0.15); }
    
    .fade-in { animation: fadeIn 0.3s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .glow-effect { box-shadow: 0 0 30px rgba(168, 230, 61, 0.3); }
    
    .dish-image { 
      width: 100%; 
      height: 160px; 
      background: linear-gradient(135deg, #2A2A2A 0%, #1A1A1A 100%);
      border-radius: 12px 12px 0 0;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .dish-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  </style>
</head>
<body class="h-full bg-[#0D0D0D] text-white overflow-auto">
  <div id="app" class="w-full min-h-full max-w-2xl mx-auto relative">
    
    <!-- Sticky Header -->
    <header class="sticky top-0 z-50 bg-[#0D0D0D]/95 backdrop-blur-md border-b border-[#2A2A2A] px-4 py-4">
      <div class="flex items-center gap-3">
        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-[#A8E63D] to-[#7BC62D] flex items-center justify-center glow-effect">
          <span class="text-2xl">üçΩÔ∏è</span>
        </div>
        <div>
          <h1 id="header-name" class="font-heading font-bold text-xl text-white leading-tight">Zixy Bite</h1>
          <p id="header-tagline" class="text-xs text-[#888888]">Delicious Food, Delivered Hot</p>
        </div>
      </div>
    </header>
    
    <!-- Search Bar -->
    <div class="sticky top-16 z-40 bg-[#0D0D0D]/95 backdrop-blur-md px-4 py-3 border-b border-[#2A2A2A]">
      <div class="relative">
        <span class="absolute left-3 top-3 text-[#888888]">üîç</span>
        <input 
          type="text" 
          id="search-input" 
          placeholder="Search dishes..." 
          class="w-full pl-10 pr-4 py-2 rounded-lg bg-[#1A1A1A] border border-[#2A2A2A] text-white placeholder-[#888888] focus:outline-none focus:border-[#A8E63D] transition-all"
        >
      </div>
    </div>
    
    <!-- Category Pills (Sticky) -->
    <nav class="sticky top-28 z-40 bg-[#0D0D0D]/95 backdrop-blur-md py-3 px-4 border-b border-[#2A2A2A]">
      <div id="category-pills" class="flex gap-2 overflow-x-auto hide-scrollbar">
        <!-- Pills injected by JS -->
      </div>
    </nav>
    
    <!-- Menu Sections -->
    <main id="menu-container" class="px-4 py-6 space-y-8">
      <!-- Menu sections injected by JS -->
    </main>
    
  </div>
<script>
   

    const defaultConfig = {
      restaurant_name: "Zixy Bite",
      tagline: "Delicious Food, Delivered Hot",
      location: "",
      phone: "",
      timing: "10 AM ‚Äì 11 PM"
    };

    let activeCategory = "All";
    let searchQuery = "";

    // Search functionality
    document.getElementById('search-input').addEventListener('input', (e) => {
      searchQuery = e.target.value.toLowerCase();
      renderMenu();
    });

    function renderCategoryPills() {
      const container = document.getElementById('category-pills');
      const categories = ["All", ...menuData.map(c => c.category)];
      
      container.innerHTML = categories.map(cat => `
        <button class="category-pill flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium border border-[#2A2A2A] bg-[#1A1A1A] text-[#888888] whitespace-nowrap ${activeCategory === cat ? 'active' : ''}" data-category="${cat}">
          ${cat === "All" ? "üçΩÔ∏è All" : `${menuData.find(c => c.category === cat)?.emoji || ''} ${cat}`}
        </button>
      `).join('');
      
      container.querySelectorAll('.category-pill').forEach(btn => {
        btn.addEventListener('click', () => {
          activeCategory = btn.dataset.category;
          document.getElementById('search-input').value = "";
          searchQuery = "";
          renderCategoryPills();
          renderMenu();
          
          if (activeCategory !== "All") {
            const section = document.getElementById(`section-${activeCategory.replace(/\s+/g, '-').toLowerCase()}`);
            if (section) {
              setTimeout(() => section.scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);
            }
          }
        });
      });
    }

    function renderMenu() {
      const container = document.getElementById('menu-container');
      let filteredData = activeCategory === "All" 
        ? menuData 
        : menuData.filter(c => c.category === activeCategory);

      // Apply search filter
      if (searchQuery) {
        filteredData = filteredData.map(category => ({
          ...category,
          items: category.items.filter(item => 
            item.name.toLowerCase().includes(searchQuery)
          )
        })).filter(category => category.items.length > 0);
      }

      if (filteredData.length === 0) {
        container.innerHTML = `
          <div class="text-center py-12">
            <span class="text-6xl mb-4 block">üîç</span>
            <h3 class="font-heading font-bold text-xl text-white mb-2">No dishes found</h3>
            <p class="text-[#888888]">Try searching for something else</p>
          </div>
        `;
        return;
      }

      container.innerHTML = filteredData.map(category => `
        <section id="section-${category.category.replace(/\s+/g, '-').toLowerCase()}" class="fade-in">
          <div class="flex items-center gap-2 mb-4 sticky top-32 bg-[#0D0D0D] py-2 z-30">
            <span class="text-3xl">${category.emoji}</span>
            <h2 class="font-heading font-bold text-2xl text-white">${category.category}</h2>
            <span class="text-xs text-[#888888] bg-[#1A1A1A] px-3 py-1 rounded-full">${category.items.length}</span>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
            ${category.items.map(item => `
              <div class="menu-card bg-[#1A1A1A] rounded-2xl overflow-hidden border border-[#2A2A2A]">
                <div class="dish-image">
                  <img src="${item.image_url}" alt="${item.name}" loading="lazy" onerror="this.style.display='none'; this.parentElement.innerHTML='${category.emoji}';">
                </div>
                <div class="p-4">
                  <h3 class="font-heading font-bold text-white text-sm leading-snug">${item.name}</h3>
                  <p class="text-[#A8E63D] font-bold text-lg mt-3">‚Çπ${item.price}</p>
                </div>
              </div>
            `).join('')}
          </div>
        </section>
      `).join('');
    }

    async function onConfigChange(config) {
      document.getElementById('header-name').textContent = config.restaurant_name || defaultConfig.restaurant_name;
      document.getElementById('header-tagline').textContent = config.tagline || defaultConfig.tagline;
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["restaurant_name", config.restaurant_name || defaultConfig.restaurant_name],
        ["tagline", config.tagline || defaultConfig.tagline],
        ["location", config.location || defaultConfig.location],
        ["phone", config.phone || defaultConfig.phone],
        ["timing", config.timing || defaultConfig.timing]
      ]);
    }

    function init() {
      renderCategoryPills();
      renderMenu();
      
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues
        });
      }
    }

    init();
  </script>



<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const supabaseClient = supabase.createClient(
  "https://pxdzdwljccgdruzaqhlt.supabase.co",
  "sb_publishable_4_CsTkcZtuVeFxMSpjR8mQ_NpZaGkWX"
);

console.log("Connected:", supabaseClient);


async function loadMenu(category = "All") {

  let query = supabaseClient
    .from("menu")
    .select("*");

  if (category !== "All") {
    query = query.eq("category", category);
  }

  const { data, error } = await query;

  if (error) {
    console.error(error);
    return;
  }

  const container = document.getElementById("menu-container");
  container.innerHTML = "";

  data.forEach(item => {
    container.innerHTML += `
      <div class="bg-[#1e203b] rounded-xl overflow-hidden">
        <img src="${item.image}" class="w-full h-52 object-cover">
        <div class="p-4">
          <h2 class="text-lg font-semibold">${item.name}</h2>
          <p class="text-yellow-400 font-bold">‚Çπ${item.price}</p>
        </div>
      </div>
    `;
  });
}

loadMenu();
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cfa4cc4616f0186',t:'MTc3MTM4Mzg5Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>